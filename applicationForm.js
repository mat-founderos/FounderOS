let currentStep=0,currentFormData={};$(document).ready((function(){function e(){i.css("width",(currentStep+1)/l*100+"%")}function t(){c.hide().eq(currentStep).show(),$(".multistep-form-previous-modal").toggle(currentStep>0),$(".multistep-form-next-modal").toggle(currentStep<l-1)}function o(){$(".multistep-form-modal input, .multistep-form-modal select, .multistep-form-modal textarea").each((function(){const e=$(this).attr("name")||$(this).attr("id");e&&($(this).is(":checkbox")?currentFormData[e]=$(this).prop("checked"):$(this).is(":radio")?$(this).prop("checked")&&(currentFormData[e]=$(this).val()):currentFormData[e]=$(this).val().trim())}))}const n="https://founderos.app.n8n.cloud/webhook/webhook/partial-lead";async function r(){o();try{if(!(await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"partial",formData:currentFormData,step:currentStep,timestamp:(new Date).toISOString()})})).ok)throw new Error("Failed to send partial data")}catch(e){console.error("Partial data send failed:",e)}}async function a(o){let n=c.eq(currentStep);if(1!==o||function(e){let t=e.find(".multiform-textfield"),o=e.find("input[type='radio']"),n=e.find("input[type='checkbox']"),r=e.find("#Email"),a=e.find("#Phone-Number"),c=e.find(".multistep-form-error"),i=!0;var l;return r.length&&(l=r.val().trim(),/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l)||(c.text("Please enter a valid email address.").show(),i=!1)),a.length&&/[a-zA-Z]/.test(a.val().trim())&&(c.text("Phone number should not contain letters.").show(),i=!1),t.length&&n.length?t.val().trim()||n.is(":checked")||(c.text("Please fill out this field or check the box.").show(),i=!1):(t.length&&!t.val().trim()&&(c.text("Please fill out this field.").show(),i=!1),n.length&&!n.is(":checked")&&(c.text("Please select at least one to proceed.").show(),i=!1)),o.length&&!o.is(":checked")&&(c.text("Please select an option.").show(),i=!1),i&&c.hide(),i}(n)){if(currentStep+=o,window.fathom){const e=`Application Form Submit (Step: ${currentStep+1})`;fathom.trackEvent(e)}t(),e(),await r()}}const c=$(".multistep-form-step-modal "),i=$(".multistep-form-progressbar-progress-modal"),l=c.length;$(".msf-button, .multistep-form-next-modal ").click((()=>a(1))),$(".multistep-form-previous-modal ").click((()=>a(-1))),$(".multistep-choice").change((function(){$("#first-question-no").is(":checked")?window.location.href="/revenue-accelerator":a(1)})),$("#first-question-no").on("click",(function(){window.location.href="/revenue-accelerator"})),t(),e(),$(".multistep-form-modal").submit((function(e){e.preventDefault(),o();let t=encodeURIComponent(currentFormData["Full-Name"]||""),n=encodeURIComponent(currentFormData.Email||""),r=encodeURIComponent(currentFormData.phone||""),a=!1;$("input[type='radio']:checked").each((function(){"intro-call"===$(this).data("redirection")&&(a=!0)}));let c=a?"/intro-call":"/call";window.location.href=`${c}?firstname=${t}&phone=${r}&email=${n}`})),document.querySelectorAll(".multistep-choice-checkbox input").forEach((e=>{e.addEventListener("change",(()=>{const t=e.closest(".multistep-choice-checkbox");e.checked?t.style.backgroundColor="#ffffff4d":t.style.backgroundColor=""}))})),document.querySelectorAll(".multistep-choice-last input").forEach((e=>{e.addEventListener("change",(()=>{!function(e,t){document.querySelectorAll(t).forEach((e=>{e.style.backgroundColor=""}));const o=e.closest(t);e.checked&&(o.style.backgroundColor="#ffffff4d")}(e,".multistep-choice-last"),r()}))})),$(document).on("keydown",(function(e){"Enter"===e.key&&(e.preventDefault(),$(".multistep-form-next-modal ").click()),"Escape"===e.key&&(document.querySelector(".modal-wrapper").style.display="none",document.body.style.overflow="")})),document.addEventListener("click",(function(e){e.target.closest(".application-open")&&(document.querySelectorAll(".appplication-form-modal").forEach((e=>e.style.display="flex")),document.body.style.overflow="hidden"),e.target.closest(".application-close")&&(document.querySelectorAll(".appplication-form-modal").forEach((e=>e.style.display="none")),document.body.style.overflow="")})),window.addEventListener("beforeunload",(async function(e){o();try{await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"partial",formData:currentFormData,step:currentStep,timestamp:(new Date).toISOString()}),keepalive:!0})}catch(e){console.error("Failed to send data before unload:",e)}})),console.error=function(){}}));