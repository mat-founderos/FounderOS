let currentStep=0,currentFormData={};$(document).ready((function(){const t=$(".multistep-form-step"),e=$(".multistep-form-progressbar-progress"),o=t.length,n="https://founderos.app.n8n.cloud/webhook/b82aaa3a-642a-41ce-a02f-22e8d93bbd11";function r(){e.css("width",(currentStep+1)/o*100+"%")}function i(){t.hide().eq(currentStep).show(),$(".multistep-form-previous").toggle(currentStep>0),$(".multistep-form-next").toggle(currentStep<o-1)}function c(){$(".multistep-form input, .multistep-form select, .multistep-form textarea").each((function(){const t=$(this).attr("name")||$(this).attr("id");t&&($(this).is(":checkbox")?currentFormData[t]=$(this).prop("checked"):$(this).is(":radio")?$(this).prop("checked")&&(currentFormData[t]=$(this).val()):currentFormData[t]=$(this).val().trim())}))}async function a(){c();try{if(!(await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"partial",formData:currentFormData,step:currentStep,timestamp:(new Date).toISOString()})})).ok)throw new Error("Failed to send partial data")}catch(t){console.error("Partial data send failed:",t)}}async function l(e){let o=t.eq(currentStep);if(1!==e||function(t){let e=t.find(".multiform-textfield"),o=t.find("input[type='radio']"),n=t.find("input[type='checkbox']"),r=t.find("#Email"),i=t.find("#Phone-Number"),c=t.find(".multistep-form-error"),a=!0;var l;return r.length&&(l=r.val().trim(),!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l))&&(c.text("Please enter a valid email address.").show(),a=!1),i.length&&/[a-zA-Z]/.test(i.val().trim())&&(c.text("Phone number should not contain letters.").show(),a=!1),e.length&&n.length?e.val().trim()||n.is(":checked")||(c.text("Please fill out this field or check the box.").show(),a=!1):(e.length&&!e.val().trim()&&(c.text("Please fill out this field.").show(),a=!1),n.length&&!n.is(":checked")&&(c.text("Please select at least one to proceed.").show(),a=!1)),o.length&&!o.is(":checked")&&(c.text("Please select an option.").show(),a=!1),a&&c.hide(),a}(o)){if(currentStep+=e,window.fathom){const t=`Application Form Submit (Step: ${currentStep+1})`;fathom.trackEvent(t)}i(),r(),await a()}}$(".msf-button, .multistep-form-next").click((()=>l(1))),$(".multistep-form-previous").click((()=>l(-1))),$(".multistep-choice").change((function(){$("#first-question-no").is(":checked")?window.location.href="/training":l(1)})),$("#first-question-no").on("click",(function(){window.location.href="/training"})),i(),r(),$(".multistep-form").submit((function(t){t.preventDefault(),c();let e=encodeURIComponent(currentFormData["Full-Name"]||""),o=encodeURIComponent(currentFormData.Email||""),n=encodeURIComponent(currentFormData.phone||""),r=!1;$("input[type='radio']:checked").each((function(){"intro-call"===$(this).data("redirection")&&(r=!0)}));let i=r?"/intro-call":"/call";window.location.href=`${i}?firstname=${e}&phone=${n}&email=${o}`})),document.querySelectorAll(".multistep-choice-checkbox input").forEach((t=>{t.addEventListener("change",(()=>{const e=t.closest(".multistep-choice-checkbox");t.checked?e.style.backgroundColor="#ffffff4d":e.style.backgroundColor="",a()}))})),document.querySelectorAll(".multistep-choice-last input").forEach((t=>{t.addEventListener("change",(()=>{!function(t,e){document.querySelectorAll(e).forEach((t=>{t.style.backgroundColor=""}));const o=t.closest(e);t.checked&&(o.style.backgroundColor="#ffffff4d")}(t,".multistep-choice-last"),a()}))})),$(document).on("keydown",(function(t){"Enter"===t.key&&(t.preventDefault(),$(".multistep-form-next").click()),"Escape"===t.key&&(document.querySelector(".modal-wrapper").style.display="none",document.body.style.overflow="")})),document.addEventListener("click",(function(t){t.target.closest(".application-open")&&(document.querySelectorAll(".appplication-form-modal").forEach((t=>t.style.display="flex")),document.body.style.overflow="hidden"),t.target.closest(".application-close")&&(document.querySelectorAll(".appplication-form-modal").forEach((t=>t.style.display="none")),document.body.style.overflow="")})),window.addEventListener("beforeunload",(async function(t){c();try{await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"partial",formData:currentFormData,step:currentStep,timestamp:(new Date).toISOString()}),keepalive:!0})}catch(t){console.error("Failed to send data before unload:",t)}})),console.error=function(){}}));